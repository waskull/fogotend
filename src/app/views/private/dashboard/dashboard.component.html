<!-- Header -->
<header class="bg-surface-primary mt-5">
    <div class="container-fluid">
        <div class="mb-npx">
            <div class="row align-items-center justify-content-between">
                <div class="col-sm-6 col-12  mb-4 mb-sm-0">
                    <!-- <h2 class="text-red">Bienvenido
                        <span class="text-default poppings">{{getUserInfo()}}</span>
                    </h2> -->

                </div>
                <div class="text-center align mt-4">
                    <div class="mx-n1">
                        <span class=" mx-auto h2 mb-0 ls-tight"
                            style="font-weight: 900;text-shadow: 1px 1px black;">Visión General</span>
                    </div>
                </div>
            </div>
            <ul class="nav nav-tabs mt-4 overflow-x border-0">
            </ul>
        </div>
    </div>
</header>
<main class="py-6 bg-surface-secondary">
    <div class="container   pb-4">
        <div class="row g-6 mb-6 ">
            @if (getRol() !== CLIENT) {
            <div class="col-xl-3 col-sm-6 col-md-6 col-12 mb-2">
                <div class="card dark cardCursor text-white shadow border-0">
                    <a style="text-decoration: none;" class="text-white" routerLink="/products">
                        <div class="card-body">
                            <div class="row">
                                @if (!loadingCards) {
                                <div class="col"> <span class="h6 font-semibold  text-sm d-block mb-2">Contamos
                                        con </span> <span class="h5 poppings font-bold mb-0">{{stats?.item}}
                                        productos</span>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape dark text-white text-lg rounded-circle"> <i
                                            class="fa-solid fa-utensils"></i> </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm"> <span
                                        class="badge badge-pill bg-soft-success text-success me-2"> </span> <span
                                        class="text-nowrap text-xs ">registrados.</span> </div>
                                }
                                @else {
                                <div class="spinner-border text-light text-center container mt-2 mb-2"
                                    style="width: 5rem; height: 5rem;" role="status">
                                    <span class="visually-hidden">Cargando...</span>
                                </div>
                                }
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <div class="col-xl-3 col-sm-6 col-md-6 col-12 mb-2">
                <div class="card default cardCursor text-white shadow border-0">
                    <a style="text-decoration: none;" class="text-white" routerLink="/users">
                        <div class="card-body">
                            <div class="row">
                                @if (!loadingCards) {
                                <div class="col"> <span class="h6 font-semibold  text-sm d-block mb-2">Contamos
                                        con </span> <span class="h5 poppings font-bold mb-0">{{stats?.users}}
                                        clientes</span>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape default text-white text-lg rounded-circle"> <i
                                            class="fa-solid fa-user-group"></i> </div>
                                </div>

                                <div class="mt-2 mb-0 text-sm"> <span
                                        class="badge badge-pill bg-soft-success text-success me-2"> </span> <span
                                        class="text-nowrap text-xs ">registrados en FOGÓN.</span> </div>
                                }
                                @else {
                                <div class="spinner-border text-light text-center container mt-2 mb-2"
                                    style="width: 5rem; height: 5rem;" role="status">
                                    <span class="visually-hidden">Cargando...</span>
                                </div>
                                }
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6 col-md-6 col-12 mb-2">
                <div class="card red cardCursor text-white shadow border-0">
                    <a style="text-decoration: none;" class="text-white" routerLink="/sales">
                        <div class="card-body">
                            <div class="row">
                                @if (!loadingCards) {
                                <div class="col"> <span class="h6 font-semibold  text-sm d-block mb-2">Se han realizado
                                    </span> <span class="h5 poppings font-bold mb-0">{{stats?.sales}} entregas</span>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape red text-white text-lg rounded-circle"> <i
                                            class="fa-solid fa-cart-flatbed"></i> </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm"> <span
                                        class="badge badge-pill bg-soft-danger text-danger me-2"></span> <span
                                        class="text-nowrap text-xs ">totales.</span> </div>
                                }
                                @else {
                                <div class="spinner-border text-light text-center container mt-2 mb-2"
                                    style="width: 5rem; height: 5rem;" role="status">
                                    <span class="visually-hidden">Cargando...</span>
                                </div>
                                }
                            </div>

                        </div>
                    </a>
                </div>
            </div>

            <div class="col-xl-3 col-sm-6 col-md-6 col-12 ">
                <div class="card yellow cardCursor shadow border-0">
                    <a style="text-decoration: none;" class="text-black" routerLink="/sales">
                        <div class="card-body">
                            <div class="row">
                                @if (!loadingCards) {
                                <div class="col"> <span class="h6 font-semibold  text-sm d-block mb-2 text-black">Hay
                                    </span>
                                    <span class="h5 poppings font-bold mb-0 text-black">{{stats?.incompletes}}
                                        pedidos </span>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape yellow text-black text-lg rounded-circle"> <i
                                            class="fa-solid fa-cash-register text-black"></i> </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm"> <span
                                        class="badge badge-pill bg-soft-success text-success me-2"> </span> <span
                                        class="text-nowrap text-xs text-black">pendientes.</span> </div>
                                }
                                @else {
                                <div class="spinner-border text-dark text-center container mt-2 mb-2"
                                    style="width: 5rem; height: 5rem;" role="status">
                                    <span class="visually-hidden">Cargando...</span>
                                </div>
                                }
                            </div>

                        </div>
                    </a>
                </div>
            </div>
            }
        </div>

        @if (getRol() === CLIENT) {
        <div class="container text-center">
            <button routerLink="/sales" class="btn btn-lg btn-primary">
                <span>Ver mis pedidos</span>
            </button>
        </div>
        }

        @if (getRol() !== CLIENT) {
        <div class="container text-center">
            <div class="row">
                <div class=" align-self-center">
                    <h4 class="text-center mt-2" style="font-weight: 600;">VENTAS DE LOS ULTIMOS 7 DIAS</h4>
                    <div class="card shadow border-0 mb-4 mt-1">
                        <canvas style="height: 50vh" id="myChart3"></canvas>

                    </div>
                </div>
            </div>
        </div>
        }

        <div class="card shadow-none mt-lg-3 border-0 mb-7 ">
            <div class="card-header text-bg-dark">
                @if (getRol() === CLIENT) {
                <h5 class="mb-0 " style="font-weight: 600;">Mis últimos 5 pedidos</h5>
                }
                @else{
                <h5 class="mb-0 " style="font-weight: 600;">Últimos 5 pedidos</h5>
                }

            </div>
            @if (loading) {
            <div class="spinner-grow text-dark text-center container mt-2 mb-2" style="width: 5rem; height: 5rem;"
                role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <span class="text-dark text-center mb-4">Cargando...</span>
            }
            @else {
            <app-table [colNames]="columnNames" [columns]="columns" [rowData]="sales"
                [operations]="{edit:false,delete:false}" (onEdit)="editItem($event)" (onDelete)="deleteItem($event)"
                [hideSearch]="true"></app-table>
            }
        </div>

        <div class="container">
            <div class="row">
                <div class="col-6">
                    <h4 class="text-center mt-2" style="font-weight: 600;">PRODUCTOS MÁS VENDIDOS</h4>
                    <div class="card shadow border-0 mb-7">
                        <canvas id="myChart"></canvas>

                    </div>
                </div>
                <div class="col-6">
                    <h4 class="text-center mt-2" style="font-weight: 600;">TOP 5 CLIENTES</h4>
                    <div class="card shadow border-0 mb-7">
                        <canvas id="myChart2"></canvas>

                    </div>
                </div>
            </div>

        </div>
    </div>
</main>